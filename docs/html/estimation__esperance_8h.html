<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: src/infer_haplo/estimation_esperance.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('estimation__esperance_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">estimation_esperance.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Computes the log-likelihood from genotype probabilities.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;unordered_map&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &quot;<a class="el" href="vector__hash_8h_source.html">vector_hash.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="explain__genotype_8h_source.html">explain_genotype.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for estimation_esperance.h:</div>
<div class="dyncontent">
<div class="center"><img src="estimation__esperance_8h__incl.png" border="0" usemap="#asrc_2infer__haplo_2estimation__esperance_8h" alt=""/></div>
<map name="asrc_2infer__haplo_2estimation__esperance_8h" id="asrc_2infer__haplo_2estimation__esperance_8h">
<area shape="rect" title="Computes the log&#45;likelihood from genotype probabilities." alt="" coords="227,5,398,46"/>
<area shape="rect" title=" " alt="" coords="5,94,116,120"/>
<area shape="poly" title=" " alt="" coords="250,49,115,91,113,86,249,44"/>
<area shape="rect" title=" " alt="" coords="122,168,180,193"/>
<area shape="poly" title=" " alt="" coords="249,49,212,68,180,96,164,124,157,153,151,152,159,122,176,92,209,64,247,44"/>
<area shape="rect" title=" " alt="" coords="476,94,533,120"/>
<area shape="poly" title=" " alt="" coords="361,44,463,86,461,91,359,49"/>
<area shape="rect" title=" " alt="" coords="557,94,628,120"/>
<area shape="poly" title=" " alt="" coords="383,44,543,89,541,94,382,49"/>
<area shape="rect" href="vector__hash_8h.html" title="Custom hash function for std::vector&lt;int&gt; to be used in hash&#45;based containers." alt="" coords="190,94,294,120"/>
<area shape="poly" title=" " alt="" coords="297,48,265,84,261,80,293,45"/>
<area shape="rect" href="explain__genotype_8h.html" title="Checks whether a pair of haplotypes can explain a given genotype." alt="" coords="318,94,451,120"/>
<area shape="poly" title=" " alt="" coords="332,45,365,80,361,84,328,48"/>
<area shape="poly" title=" " alt="" coords="228,122,180,160,176,156,225,118"/>
<area shape="rect" title=" " alt="" coords="204,168,282,193"/>
<area shape="poly" title=" " alt="" coords="245,120,245,152,240,152,239,120"/>
<area shape="rect" title=" " alt="" coords="306,168,351,193"/>
<area shape="poly" title=" " alt="" coords="258,118,304,156,301,160,255,122"/>
<area shape="rect" title=" " alt="" coords="376,168,444,193"/>
<area shape="poly" title=" " alt="" coords="271,118,368,159,366,164,269,123"/>
<area shape="poly" title=" " alt="" coords="346,123,195,169,194,163,344,118"/>
<area shape="poly" title=" " alt="" coords="377,122,349,157,345,154,373,118"/>
<area shape="poly" title=" " alt="" coords="391,119,403,152,398,154,386,121"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="estimation__esperance_8h__dep__incl.png" border="0" usemap="#asrc_2infer__haplo_2estimation__esperance_8hdep" alt=""/></div>
<map name="asrc_2infer__haplo_2estimation__esperance_8hdep" id="asrc_2infer__haplo_2estimation__esperance_8hdep">
<area shape="rect" title="Computes the log&#45;likelihood from genotype probabilities." alt="" coords="5,5,176,46"/>
<area shape="rect" href="infer__haplo_8cpp.html" title=" " alt="" coords="23,94,158,135"/>
<area shape="poly" title=" " alt="" coords="93,62,93,94,88,94,88,62"/>
</map>
</div>
</div>
<p><a href="estimation__esperance_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9e8b043393ccaa9b0cd1c043e5a15988" id="r_a9e8b043393ccaa9b0cd1c043e5a15988"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e8b043393ccaa9b0cd1c043e5a15988">estimation_esperance</a> (const std::vector&lt; std::vector&lt; int &gt; &gt; &amp;genotypes, const std::vector&lt; std::vector&lt; int &gt; &gt; &amp;haplotypes, const std::unordered_map&lt; std::vector&lt; int &gt;, double, <a class="el" href="struct_vector_hash.html">VectorHash</a> &gt; &amp;frequencies)</td></tr>
<tr class="separator:a9e8b043393ccaa9b0cd1c043e5a15988"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Computes the log-likelihood from genotype probabilities. </p>
<dl class="section author"><dt>Author</dt><dd>Ahamed TCHATAKOURA </dd>
<dd>
Mawu√©na AHONDO </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025-03-03 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<p>This header file declares the function <code>estimation_esperance</code>, which calculates the log-likelihood value based on haplotype frequencies and observed genotypes. The function iterates over all genotypes and sums the logarithm of their probabilities to determine the overall likelihood of the observed data.</p>
<h1><a class="anchor" id="Features"></a>
Key Features</h1>
<ul>
<li>Computes the log-likelihood for a given set of genotypes and haplotype frequencies.</li>
<li>Supports a vector-based representation of genotypes and haplotypes.</li>
<li>Uses logarithmic scaling to improve numerical stability.</li>
</ul>
<h1><a class="anchor" id="Preconditions"></a>
Preconditions</h1>
<ul>
<li>The <code>genotypes</code> matrix must be provided as a vector of vectors of integers.</li>
<li>The <code>haplotypes</code> set must be a vector of vectors of integers representing all candidate haplotypes.</li>
<li>The <code>frequencies</code> map must contain valid frequency values for all haplotypes.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">genotypes</td><td>A vector of vectors of integers representing the genotype matrix. </td></tr>
    <tr><td class="paramname">haplotypes</td><td>A vector of vectors of integers representing the haplotypes. </td></tr>
    <tr><td class="paramname">frequencies</td><td>An unordered map with vectors of integers as keys and doubles as values, representing the frequencies corresponding to each haplotype.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>If the input data is empty or incorrectly formatted. </td></tr>
    <tr><td class="paramname">std::out_of_range</td><td>If an expected haplotype is not found in the frequency map.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed log-likelihood value based on the provided genotype data and haplotype frequencies.</dd></dl>
<h1><a class="anchor" id="Example"></a>
Usage Example</h1>
<div class="fragment"><div class="line">std::vector&lt;std::vector&lt;int&gt;&gt; genotypes = {{0,1,2}, {1,0,1}};</div>
<div class="line">std::vector&lt;std::vector&lt;int&gt;&gt; haplotypes = {{0,1,1}, {1,0,1}};</div>
<div class="line">std::unordered_map&lt;std::vector&lt;int&gt;, double, <a class="code hl_struct" href="struct_vector_hash.html">VectorHash</a>&gt; frequencies = {</div>
<div class="line">    {{0,1,1}, 0.6}, {{1,0,1}, 0.4}</div>
<div class="line">};</div>
<div class="line"><span class="keywordtype">double</span> logLikelihood = <a class="code hl_function" href="#a9e8b043393ccaa9b0cd1c043e5a15988">estimation_esperance</a>(genotypes, haplotypes, frequencies);</div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;Log-likelihood: &quot;</span> &lt;&lt; logLikelihood &lt;&lt; std::endl;</div>
<div class="ttc" id="aestimation__esperance_8h_html_a9e8b043393ccaa9b0cd1c043e5a15988"><div class="ttname"><a href="#a9e8b043393ccaa9b0cd1c043e5a15988">estimation_esperance</a></div><div class="ttdeci">double estimation_esperance(const std::vector&lt; std::vector&lt; int &gt; &gt; &amp;genotypes, const std::vector&lt; std::vector&lt; int &gt; &gt; &amp;haplotypes, const std::unordered_map&lt; std::vector&lt; int &gt;, double, VectorHash &gt; &amp;frequencies)</div><div class="ttdef"><b>Definition</b> estimation_esperance.h:62</div></div>
<div class="ttc" id="astruct_vector_hash_html"><div class="ttname"><a href="struct_vector_hash.html">VectorHash</a></div><div class="ttdoc">Custom hash function for std::vector&lt;int&gt;.</div><div class="ttdef"><b>Definition</b> vector_hash.h:64</div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="calcul__proba__genotypes_8h.html#a0b58eca8395af4a7e32f94e02f6717f9">calcul_proba_genotypes()</a> </dd>
<dd>
<a class="el" href="maximisation_8h.html#a0797128ff407a2c68fb2d38c7ac06994" title="Updates haplotype frequencies based on observed genotypes and their probabilities.">maximisation()</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9e8b043393ccaa9b0cd1c043e5a15988" name="a9e8b043393ccaa9b0cd1c043e5a15988"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e8b043393ccaa9b0cd1c043e5a15988">&#9670;&#160;</a></span>estimation_esperance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double estimation_esperance </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>genotypes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>haplotypes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_map&lt; std::vector&lt; int &gt;, double, <a class="el" href="struct_vector_hash.html">VectorHash</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>frequencies</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_02562e19831dcc69abfa266821d7ed54.html">infer_haplo</a></li><li class="navelem"><a class="el" href="estimation__esperance_8h.html">estimation_esperance.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
